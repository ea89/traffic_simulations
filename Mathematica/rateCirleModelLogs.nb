(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45659,       1130]
NotebookOptionsPosition[     44071,       1074]
NotebookOutlinePosition[     44413,       1089]
CellTagsIndexPosition[     44370,       1086]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "equations", " ", "are", " ", "computed", " ", "in", " ", "the",
    " ", 
   RowBox[{"adsorptionss", ".", "nb"}], " ", "file", " ", 
   RowBox[{"(", 
    RowBox[{
    "check", " ", "to", " ", "make", " ", "sure", " ", "you", " ", "got", " ",
      "the", " ", "correct", " ", "roots"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.678216603091364*^9, 3.6782166242644305`*^9}, {
  3.678228889328361*^9, 3.6782288953721514`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Nt", " ", "is", " ", "the", " ", "population", " ", "to", " ", "the", " ",
     "town", " ", 
    RowBox[{"(", 
     RowBox[{"people", " ", "who", " ", "want", " ", "to", " ", "park"}], 
     ")"}], " ", "and", " ", "Nv", " ", "is", " ", "the", " ", "population", 
    " ", "that", " ", "is", " ", "trying", " ", "to", " ", "go", " ", "to", 
    " ", "the", " ", "village", " ", 
    RowBox[{"(", 
     RowBox[{
     "people", " ", "who", " ", "want", " ", "to", " ", "go", " ", 
      "through"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"clear", " ", "the", " ", "workspace"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.678216631339923*^9, 3.6782166368355093`*^9}, {
  3.6782267765844383`*^9, 3.6782268013330345`*^9}, {3.6782268901891413`*^9, 
  3.6782268910337467`*^9}, {3.6782277331529055`*^9, 3.678227764878302*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"define", " ", "helper", " ", "functions"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6732577724771004`*^9, 3.673257842035119*^9}, {
   3.6732579145440707`*^9, 3.673257915578106*^9}, {3.6732655242366123`*^9, 
   3.673265626561434*^9}, {3.6732657101848173`*^9, 3.6732657113388305`*^9}, {
   3.6732657476078453`*^9, 3.6732657575001287`*^9}, {3.6732658620147066`*^9, 
   3.673265865807675*^9}, {3.6732660793845696`*^9, 3.673266111075303*^9}, {
   3.6732665260609813`*^9, 3.6732665436027637`*^9}, {3.673266687607851*^9, 
   3.673266721893676*^9}, {3.673267274070509*^9, 3.6732674270785108`*^9}, {
   3.67326747415711*^9, 3.673267479105139*^9}, {3.673267532593253*^9, 
   3.673267545175604*^9}, {3.673268250647987*^9, 3.6732683039430213`*^9}, {
   3.673268366053914*^9, 3.6732683661514835`*^9}, {3.6732688620891047`*^9, 
   3.6732688623697367`*^9}, {3.673350962112729*^9, 3.673350984196308*^9}, {
   3.6733513420311213`*^9, 3.67335135672093*^9}, {3.673351725253417*^9, 
   3.6733517253184624`*^9}, {3.6733521691670384`*^9, 3.673352169722932*^9}, {
   3.6733550724713154`*^9, 3.6733550751562457`*^9}, 3.678216331149429*^9, {
   3.6782163673828993`*^9, 3.678216373343532*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ps", "[", 
    RowBox[{"Nt_", ",", "L_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Nt", "/", "L"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{
   "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", "p_", ",", " ", 
    "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{
    "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", "L",
      ",", "d", ",", " ", "Nv"}], "]"}], " ", "=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"Exp", "[", " ", 
        RowBox[{
         RowBox[{"-", "1"}], " ", "*", " ", "lambda", " ", "*", " ", "L", " ",
          "*", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Nt", "/", "L"}], " ", "*", " ", 
              RowBox[{"(", 
               RowBox[{"1", "/", " ", 
                RowBox[{"(", 
                 RowBox[{"1", " ", "+", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "*", "#"}], ")"}], "/", "L"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "d"}], ")"}], "/", "mun"}], " ", "+", 
                    " ", 
                    RowBox[{
                    RowBox[{"(", "d", ")"}], "/", "mud"}]}], ")"}]}]}], 
                 ")"}]}], ")"}]}], ")"}], " ", "+", " ", 
            RowBox[{"Nv", "/", "L"}], " ", "-", " ", 
            RowBox[{"ps", "[", 
             RowBox[{"Nt", ",", "L"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"p", " ", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Nt", "/", "L"}], " ", "*", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", " ", "+", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "*", "#"}], ")"}], "/", "L"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "d"}], ")"}], "/", "mun"}], " ", "+", 
                    " ", 
                    RowBox[{
                    RowBox[{"(", "d", ")"}], "/", "mud"}]}], ")"}]}]}], 
                    ")"}]}], ")"}]}], " ", "+", " ", 
                RowBox[{"Nv", "/", "L"}]}], ")"}]}], ")"}]}], ")"}]}]}], 
        "]"}]}], " ", "&"}], " ", ",", "0.5", ",", "5"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pnot", "[", 
    RowBox[{
    "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", "p_", ",", " ", 
     "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], "]"}], "  ", ":=",
    " ", 
   RowBox[{
    RowBox[{"pnot", "[", 
     RowBox[{
     "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", 
      "L", ",", "d", ",", " ", "Nv"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Nt", "/", "L"}], " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "*", 
              RowBox[{"q", "[", 
               RowBox[{
               "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", 
                "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}]}], " ", 
             ")"}], "/", "L"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "d"}], ")"}], "/", "mun"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", "d", ")"}], "/", "mud"}]}], ")"}]}]}], ")"}]}], 
       ")"}]}], " ", "+", " ", 
     RowBox[{"Nv", "/", "L"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.678226845371278*^9, {3.6782269519573917`*^9, 3.6782269524418716`*^9}, {
   3.6782270046539745`*^9, 3.6782270055022807`*^9}, {3.678227204451792*^9, 
   3.6782272271500435`*^9}, {3.678227290022215*^9, 3.67822731375427*^9}, {
   3.678227347979966*^9, 3.678227371750637*^9}, {3.6782377482500143`*^9, 
   3.6782377915126276`*^9}, {3.6782382316984253`*^9, 
   3.6782382337192764`*^9}, {3.6782388887391214`*^9, 3.678238906249612*^9}, {
   3.6782404414241223`*^9, 3.6782404416276407`*^9}, {3.6787810593104124`*^9, 
   3.678781068123564*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "compute", " ", "density", " ", "of", " ", "B", " ", "cars", " ", "for", 
    " ", "both", " ", "normal", " ", "and", " ", "driverless", " ", "cars"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pBn", "[", 
      RowBox[{
      "0", ",", " ", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", 
       "p_", ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", 
       "Nv_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pnot", "[", 
         RowBox[{
         "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",",
           "L", ",", "d", ",", " ", "Nv"}], "]"}], " ", "-", " ", 
        RowBox[{"Nv", "/", "L"}]}], ")"}], "*", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pBd", "[", 
      RowBox[{
      "0", ",", " ", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", 
       "p_", ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", 
       "Nv_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pnot", "[", 
         RowBox[{
         "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",",
           "L", ",", "d", ",", " ", "Nv"}], "]"}], " ", "-", " ", 
        RowBox[{"Nv", "/", "L"}]}], ")"}], "*", " ", 
      RowBox[{"(", "d", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pBn", "[", 
     RowBox[{
     "i_", ",", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", "p_",
       ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"pBn", "[", 
      RowBox[{
      "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", 
       ",", "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "lambda"}], " ", "mud", " ", "mun", " ", 
            "pimonebn"}], "-", 
           RowBox[{"mud", " ", "mun", " ", "p", " ", "pimonebn"}], "+", 
           RowBox[{
           "lambda", " ", "mun", " ", "p", " ", "pimonebd", " ", "pimonebn"}],
            "+", 
           RowBox[{"lambda", " ", "mud", " ", "p", " ", 
            SuperscriptBox["pimonebn", "2"]}], "+", 
           RowBox[{
           "mud", " ", "mun", " ", "p", " ", "pimonebn", " ", "pnotC"}], "+", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"lambda", " ", "mud", " ", "mun", " ", "pimonebn"}], 
                 "+", 
                 RowBox[{"mud", " ", "mun", " ", "p", " ", "pimonebn"}], "-", 
                 RowBox[{
                 "lambda", " ", "mun", " ", "p", " ", "pimonebd", " ", 
                  "pimonebn"}], "-", 
                 RowBox[{"lambda", " ", "mud", " ", "p", " ", 
                  SuperscriptBox["pimonebn", "2"]}], "-", 
                 RowBox[{
                 "mud", " ", "mun", " ", "p", " ", "pimonebn", " ", 
                  "pnotC"}]}], ")"}], "2"], "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"lambda", " ", "mun", " ", "p", " ", "pimonebd"}], 
                 "+", 
                 RowBox[{"lambda", " ", "mud", " ", "p", " ", "pimonebn"}]}], 
                ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "mud"}], " ", "mun", " ", "p", " ", 
                  SuperscriptBox["pimonebn", "2"]}], "+", 
                 RowBox[{"mud", " ", "mun", " ", "p", " ", 
                  SuperscriptBox["pimonebn", "2"], " ", "pnotC"}]}], 
                ")"}]}]}], ")"}]}]}], ")"}], "]"}], " ", "-", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lambda", " ", "mun", " ", "p", " ", "pimonebd"}], "+", 
             RowBox[{"lambda", " ", "mud", " ", "p", " ", "pimonebn"}]}], 
            ")"}]}], ")"}], "]"}]}], "]"}], "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"pnotC", "\[Rule]", " ", 
         RowBox[{"pnot", "[", 
          RowBox[{
          "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", 
           ",", "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ",", " ", 
        RowBox[{"pimonebn", "\[Rule]", " ", 
         RowBox[{"pBn", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
           " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
           "Nv"}], "]"}]}], ",", " ", 
        RowBox[{"pimonebd", "\[Rule]", " ", 
         RowBox[{"pBd", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
           " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
           "Nv"}], "]"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pBd", "[", 
     RowBox[{
     "i_", ",", " ", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", 
      "p_", ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", 
      "Nv_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"pBd", "[", 
      RowBox[{
      "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", 
       ",", "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}], "=", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"2", " ", "lambda", " ", "p", " ", "pimonebn", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mun", " ", "pimonebd"}], "+", 
             RowBox[{"mud", " ", "pimonebn"}]}], ")"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"Log", "[", 
         RowBox[{"pimonebd", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "lambda"}], " ", "mud", " ", "mun", " ", 
             "pimonebn"}], "-", 
            RowBox[{"mud", " ", "mun", " ", "p", " ", "pimonebn"}], "+", 
            RowBox[{
            "lambda", " ", "mun", " ", "p", " ", "pimonebd", " ", 
             "pimonebn"}], "+", 
            RowBox[{"lambda", " ", "mud", " ", "p", " ", 
             SuperscriptBox["pimonebn", "2"]}], "+", 
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["pimonebn", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"lambda", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "mud"}], " ", "mun"}], "+", 
                    RowBox[{"mun", " ", "p", " ", "pimonebd"}], "+", 
                    RowBox[{"mud", " ", "p", " ", "pimonebn"}]}], ")"}]}], 
                    "+", 
                    RowBox[{"mud", " ", "mun", " ", "p", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "pnotC"}], ")"}]}]}], ")"}], 
                  "2"], "-", 
                 RowBox[{"4", " ", "lambda", " ", "mud", " ", "mun", " ", 
                  SuperscriptBox["p", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mun", " ", "pimonebd"}], "+", 
                    RowBox[{"mud", " ", "pimonebn"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "pnotC"}], ")"}]}]}], ")"}]}], 
              ")"}]}], "+", 
            RowBox[{
            "mud", " ", "mun", " ", "p", " ", "pimonebn", " ", "pnotC"}]}], 
           ")"}]}], "]"}]}], "]"}], "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"pnotC", "\[Rule]", " ", 
         RowBox[{"pnot", "[", 
          RowBox[{
          "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", 
           ",", "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ",", " ", 
        RowBox[{"pimonebn", " ", "\[Rule]", " ", 
         RowBox[{"pBn", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
           " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
           "Nv"}], "]"}]}], ",", " ", 
        RowBox[{"pimonebd", " ", "\[Rule]", " ", 
         RowBox[{"pBd", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
           " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
           "Nv"}], "]"}]}]}], "}"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.678216376068679*^9, 3.6782164202974634`*^9}, {
   3.6782165261436405`*^9, 3.6782165613333673`*^9}, {3.678216662070141*^9, 
   3.6782166960162144`*^9}, {3.6782272440030913`*^9, 
   3.6782272663255086`*^9}, {3.678227382854604*^9, 3.6782274023707447`*^9}, {
   3.6782378504068336`*^9, 3.6782378902135296`*^9}, {3.678240571460805*^9, 
   3.6782405865005145`*^9}, {3.6782407121891785`*^9, 
   3.6782407134238667`*^9}, {3.6787654284558725`*^9, 3.678765428802613*^9}, 
   3.6787743285115585`*^9, 3.6787744379336743`*^9, {3.678774625697606*^9, 
   3.678774626196602*^9}, {3.678776991892287*^9, 3.6787770667352695`*^9}, {
   3.678777555146601*^9, 3.678777590916391*^9}, {3.678777742934725*^9, 
   3.678777765758028*^9}, {3.6787780751344643`*^9, 3.6787782222914476`*^9}, {
   3.6787782534796543`*^9, 3.6787783010057645`*^9}, {3.678778333806714*^9, 
   3.678778393323618*^9}, {3.6787787564058194`*^9, 3.6787787797844267`*^9}, {
   3.6787788449443626`*^9, 3.6787788992795706`*^9}, {3.6787847419705153`*^9, 
   3.678784747642311*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pBn", "[", 
  RowBox[{
  "15", ",", " ", "0.2", ",", "0.8", ",", "0.6", ",", " ", "0.5", ",", " ", 
   "3", ",", "20", ",", "0.5", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.678774444295577*^9, 3.678774486696172*^9}, {
  3.678774546448311*^9, 3.67877459440891*^9}, {3.6787746440947313`*^9, 
  3.678774665981199*^9}}],

Cell[BoxData["0.0001278525306258662`"], "Output",
 CellChangeTimes->{{3.6787745175422*^9, 3.6787745312419405`*^9}, {
   3.678774585313966*^9, 3.67877459546544*^9}, {3.6787746325136027`*^9, 
   3.6787746666163335`*^9}, 3.67877505595154*^9, 3.6787771424332976`*^9, 
   3.678777335565632*^9, {3.678777582879871*^9, 3.678777603751599*^9}, {
   3.6787777864521484`*^9, 3.6787778109788275`*^9}, 3.6787784606446123`*^9, {
   3.678778638683486*^9, 3.678778666575837*^9}, 3.6787788217256117`*^9, 
   3.6787789349516635`*^9, 3.6787821461062036`*^9, 3.6787847518627834`*^9, 
   3.678785448141838*^9, 3.6787960211323543`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6787746997881994`*^9, 3.6787747038265486`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pCn", "[", 
   RowBox[{
   "i_", ",", " ", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", 
    "p_", ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"pCn", "[", 
    RowBox[{
    "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", 
     "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        RowBox[{"2", " ", "lambda", " ", "mun", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"mun", " ", "pimonebd"}], "+", 
           RowBox[{"mud", " ", "pimonebn"}]}], ")"}]}], "]"}]}], " ", "+", 
      " ", 
      RowBox[{"Log", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lambda", " ", "mud", " ", "mun", " ", "pimonebn"}], "+", 
         RowBox[{"mud", " ", "mun", " ", "p", " ", "pimonebn"}], "+", 
         RowBox[{
         "lambda", " ", "mun", " ", "p", " ", "pimonebd", " ", "pimonebn"}], 
         "+", 
         RowBox[{"lambda", " ", "mud", " ", "p", " ", 
          SuperscriptBox["pimonebn", "2"]}], "-", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["pimonebn", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               SuperscriptBox["lambda", "2"], " ", "mud", " ", "mun", " ", 
               "p", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"mun", " ", "pimonebd"}], "+", 
                 RowBox[{"mud", " ", "pimonebn"}]}], ")"}]}], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"lambda", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mun", " ", "p", " ", "pimonebd"}], "+", 
                    RowBox[{"mud", " ", 
                    RowBox[{"(", 
                    RowBox[{"mun", "+", 
                    RowBox[{"p", " ", "pimonebn"}]}], ")"}]}]}], ")"}]}], "-", 
                 RowBox[{"mud", " ", "mun", " ", "p", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "pnotC"}], ")"}]}]}], ")"}], 
               "2"]}], ")"}]}], ")"}]}], "-", 
         RowBox[{
         "mud", " ", "mun", " ", "p", " ", "pimonebn", " ", "pnotC"}]}], 
        ")"}], "]"}]}], "]"}], "//.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pnotC", "\[Rule]", " ", 
       RowBox[{"pnot", "[", 
        RowBox[{
        "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", 
         "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ",", " ", 
      RowBox[{"pimonebn", " ", "\[Rule]", " ", 
       RowBox[{"pBn", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
         " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
         "Nv"}], "]"}]}], ",", " ", 
      RowBox[{"pimonebd", " ", "\[Rule]", " ", 
       RowBox[{"pBd", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
         " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
         "Nv"}], "]"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pCd", "[", 
   RowBox[{
   "i_", ",", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", "p_", 
    ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], "]"}],
   " ", ":=", " ", 
  RowBox[{
   RowBox[{"pCd", "[", 
    RowBox[{
    "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", 
     "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        RowBox[{"2", " ", "lambda", " ", "mud", " ", "pimonebn", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"mun", " ", "pimonebd"}], "+", 
           RowBox[{"mud", " ", "pimonebn"}]}], ")"}]}], "]"}]}], " ", "+", 
      " ", 
      RowBox[{"Log", "[", 
       RowBox[{"pimonebd", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lambda", " ", "mud", " ", "mun", " ", "pimonebn"}], "+", 
          RowBox[{"mud", " ", "mun", " ", "p", " ", "pimonebn"}], "+", 
          RowBox[{
          "lambda", " ", "mun", " ", "p", " ", "pimonebd", " ", "pimonebn"}], 
          "+", 
          RowBox[{"lambda", " ", "mud", " ", "p", " ", 
           SuperscriptBox["pimonebn", "2"]}], "-", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["pimonebn", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                SuperscriptBox["lambda", "2"], " ", "mud", " ", "mun", " ", 
                "p", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"mun", " ", "pimonebd"}], "+", 
                  RowBox[{"mud", " ", "pimonebn"}]}], ")"}]}], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"lambda", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mun", " ", "p", " ", "pimonebd"}], "+", 
                    RowBox[{"mud", " ", 
                    RowBox[{"(", 
                    RowBox[{"mun", "+", 
                    RowBox[{"p", " ", "pimonebn"}]}], ")"}]}]}], ")"}]}], "-", 
                  RowBox[{"mud", " ", "mun", " ", "p", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "pnotC"}], ")"}]}]}], ")"}], 
                "2"]}], ")"}]}], ")"}]}], "-", 
          RowBox[{
          "mud", " ", "mun", " ", "p", " ", "pimonebn", " ", "pnotC"}]}], 
         ")"}]}], "]"}]}], "]"}], "//.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pnotC", "\[Rule]", " ", 
       RowBox[{"pnot", "[", 
        RowBox[{
        "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", 
         "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ",", " ", 
      RowBox[{"pimonebn", " ", "\[Rule]", " ", 
       RowBox[{"pBn", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
         " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
         "Nv"}], "]"}]}], ",", " ", 
      RowBox[{"pimonebd", " ", "\[Rule]", " ", 
       RowBox[{"pBd", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
         " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
         "Nv"}], "]"}]}]}], "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6782165465886235`*^9, 3.6782165483048224`*^9}, {
   3.6782167020956078`*^9, 3.6782167129322643`*^9}, {3.678227273969533*^9, 
   3.678227279245723*^9}, {3.6782274087013454`*^9, 3.6782274186718016`*^9}, {
   3.678228349920755*^9, 3.678228374840186*^9}, {3.678228913519166*^9, 
   3.678228939017184*^9}, {3.678237905334366*^9, 3.6782379254792814`*^9}, 
   3.678774799242141*^9, 3.678774872385933*^9, {3.6787770757320642`*^9, 
   3.678777125023246*^9}, {3.6787775361109896`*^9, 3.678777551183764*^9}, {
   3.678777595686551*^9, 3.6787775993642416`*^9}, {3.678777771153384*^9, 
   3.678777781358364*^9}, {3.6787783983338647`*^9, 3.6787784443846297`*^9}, {
   3.678778781621667*^9, 3.6787787873516836`*^9}, {3.6787789014506836`*^9, 
   3.6787789285154085`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rateTown", " ", "[", 
   RowBox[{
   "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", "p_", ",", " ", 
    "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Sum", "[", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"pBn", "[", 
        RowBox[{
        "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", 
         ",", "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}], " ", "+", 
       " ", 
       RowBox[{"pBd", "[", 
        RowBox[{
        "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", 
         ",", "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ")"}], " ",
      "*", " ", "lambda", " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pCn", "[", 
          RowBox[{
          "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p",
            ",", "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}], " ", "+", 
         " ", 
         RowBox[{"pCd", "[", 
          RowBox[{
          "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p",
            ",", "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ")"}]}],
       ")"}]}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateCity", " ", "[", 
   RowBox[{
   "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", "p_", ",", " ", 
    "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{
   RowBox[{"Nv", "/", "L"}], " ", "*", "  ", "p", " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"1", " ", "-", " ", 
     RowBox[{"pnot", "[", 
      RowBox[{
      "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", 
       "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{3.6787749157485056`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rateTown", "[", 
          RowBox[{
          "0.5", ",", " ", "0.001", ",", " ", "0.1", ",", " ", "0.4", ",", 
           " ", 
           RowBox[{"N2", "-", " ", "Nv"}], ",", " ", "30", ",", " ", "d", ",",
            " ", "Nv"}], "]"}], ",", 
         RowBox[{"rateCity", "[", 
          RowBox[{
          "0.5", ",", " ", "0.001", ",", " ", "0.1", ",", " ", "0.4", ",", 
           " ", 
           RowBox[{"N2", " ", "-", " ", "Nv"}], ",", " ", "30", ",", " ", "d",
            ",", " ", "Nv"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Nv", ",", " ", "1", ",", 
         RowBox[{"(", "N2", ")"}], ",", "1"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Rate to town\>\"", ",", " ", "\"\<Rate to city\>\""}], 
       "}"}]}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.15"}], "}"}]}], "}"}]}]}], " ", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "0.1", ",", "0.9", ",", "0.1"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"N2", ",", " ", "12", ",", " ", "22", ",", " ", "2"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.6787749264650445`*^9, {3.6787758445409403`*^9, 3.67877584559515*^9}, {
   3.678776458746434*^9, 3.67877646142315*^9}, {3.6787819138620577`*^9, 
   3.6787819165990543`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`d$$ = 0.1, $CellContext`N2$$ = 12, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`d$$], 0.1, 0.9, 0.1}, {
      Hold[$CellContext`N2$$], 12, 22, 2}}, Typeset`size$$ = {
    360., {98., 102.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`d$64986$$ = 
    0, $CellContext`N2$64987$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`d$$ = 0.1, $CellContext`N2$$ = 12}, 
      "ControllerVariables" :> {
        Hold[$CellContext`d$$, $CellContext`d$64986$$, 0], 
        Hold[$CellContext`N2$$, $CellContext`N2$64987$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListLinePlot[
        Table[{
          $CellContext`rateTown[
          0.5, 0.001, 0.1, 0.4, $CellContext`N2$$ - $CellContext`Nv, 
           30, $CellContext`d$$, $CellContext`Nv], 
          $CellContext`rateCity[
          0.5, 0.001, 0.1, 0.4, $CellContext`N2$$ - $CellContext`Nv, 
           30, $CellContext`d$$, $CellContext`Nv]}, {$CellContext`Nv, 
          1, $CellContext`N2$$, 1}], 
        AxesLabel -> {"Rate to town", "Rate to city"}, 
        PlotRange -> {{0, 0.1}, {0, 0.15}}], 
      "Specifications" :> {{$CellContext`d$$, 0.1, 0.9, 
         0.1}, {$CellContext`N2$$, 12, 22, 2}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {157., 164.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.6787819208057356`*^9, 3.67878204186018*^9, 
  3.678782075444509*^9, 3.6787821486885395`*^9, 3.6787847520929737`*^9, 
  3.6787854483079553`*^9, 3.6787960212804403`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rateTown", "[", 
      RowBox[{
      "0.5", ",", " ", "0.001", ",", " ", "0.1", ",", " ", "0.4", ",", " ", 
       RowBox[{"20", "-", " ", "Nv"}], ",", " ", "30", ",", " ", "0.3", ",", 
       " ", "Nv"}], "]"}], ",", 
     RowBox[{"rateCity", "[", 
      RowBox[{
      "0.5", ",", " ", "0.001", ",", " ", "0.1", ",", " ", "0.4", ",", " ", 
       RowBox[{"20", " ", "-", " ", "Nv"}], ",", " ", "30", ",", " ", "0.3", 
       ",", " ", "Nv"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Nv", ",", " ", "1", ",", 
     RowBox[{"(", "20", ")"}], ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.678775331916755*^9, 3.678775347231018*^9}, {
  3.6787753825153275`*^9, 3.6787753854390345`*^9}, {3.6787758592555914`*^9, 
  3.6787758602250366`*^9}, {3.6787776889984455`*^9, 3.6787777346495657`*^9}, {
  3.6787786276961327`*^9, 3.6787786320635138`*^9}, {3.67878213543005*^9, 
  3.678782138744068*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.022116391969447542`", ",", "0.012074835757450235`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.02025557978042991`", ",", "0.02334647243620283`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.01847214451276789`", ",", "0.03381491002569765`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.016766121087427345`", ",", "0.04348014852899148`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.015137521418933726`", ",", "0.05234218794630106`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.013586349349606149`", ",", "0.06040102827763497`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.012112606047735909`", ",", "0.06765666952299343`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.010716291846685619`", ",", "0.07410911168237647`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.009397406835237555`", ",", "0.07975835475578406`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.008155951035325246`", ",", "0.08460439874321622`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.006991924451940263`", ",", "0.08864724364467295`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.005905327086120783`", ",", "0.09188688946015428`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.004896158938062343`", ",", "0.09432333618966009`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.003964420007797896`", ",", "0.09595658383319051`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.003110110295332434`", ",", "0.0967866323907455`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.002333229800666579`", ",", "0.09681348186232505`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.0016337785238004026`", ",", "0.09603713224792917`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"Indeterminate", ",", "0.09445758354755784`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Indeterminate", ",", "0.0920748357612111`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Indeterminate", ",", "0.08888888888888889`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6787821394106493`*^9, 3.6787821515280743`*^9}, 
   3.678784757108512*^9, 3.67878545242985*^9, 3.6787960235395374`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rateTown", "[", 
  RowBox[{
  "0.5", ",", " ", "0.001", ",", " ", "0.1", ",", " ", "0.4", ",", " ", 
   RowBox[{"20", "-", " ", "15"}], ",", " ", "30", ",", " ", "0.3", ",", " ", 
   "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.6787759079339495`*^9, 3.6787759109647193`*^9}, {
  3.6787774854163065`*^9, 3.6787774884558244`*^9}, {3.6787786583459654`*^9, 
  3.6787786611635313`*^9}, {3.67877894330001*^9, 3.6787789443224616`*^9}}],

Cell[BoxData["0.004181232831748057`"], "Output",
 CellChangeTimes->{
  3.678775911343419*^9, 3.678777445216564*^9, 3.67877749017135*^9, 
   3.6787776059816246`*^9, {3.678777788819661*^9, 3.6787778132900553`*^9}, 
   3.678778614767392*^9, {3.6787786489319954`*^9, 3.678778675716752*^9}, {
   3.6787789351743217`*^9, 3.6787789464843225`*^9}, 3.6787821517181873`*^9, 
   3.6787847572856364`*^9, 3.6787854525474367`*^9, 3.678796023672142*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pnot", "[", 
  RowBox[{
  "0.5", ",", " ", "0.001", ",", " ", "0.1", ",", " ", "0.4", ",", " ", 
   RowBox[{"20", "-", " ", "20"}], ",", " ", "30", ",", " ", "0.3", ",", " ", 
   "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.6787762416603518`*^9, 3.678776247330524*^9}}],

Cell[BoxData["0.6666666666666666`"], "Output",
 CellChangeTimes->{{3.67877624235245*^9, 3.678776247680949*^9}, 
   3.6787774452345767`*^9, 3.6787776060011654`*^9, {3.678777788845179*^9, 
   3.6787778133345876`*^9}, {3.678778649092248*^9, 3.6787786758447795`*^9}, 
   3.6787789351948366`*^9, 3.67878215174823*^9, 3.6787847573116837`*^9, 
   3.678785452574452*^9, 3.678796023699656*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["pBn[1, 0.5, 0.001, 0.1, 0.4, 5, 10, 0.3, 3]", "Input",
 CellChangeTimes->{{3.6782165465886235`*^9, 3.6782165483048224`*^9}, {
   3.6782167020956078`*^9, 3.6782167129322643`*^9}, {3.678227273969533*^9, 
   3.678227279245723*^9}, {3.6782274087013454`*^9, 3.6782274186718016`*^9}, {
   3.678228349920755*^9, 3.678228374840186*^9}, {3.678228913519166*^9, 
   3.678228939017184*^9}, {3.678237905334366*^9, 3.6782379254792814`*^9}, 
   3.678774799242141*^9, 3.678774872385933*^9, {3.6787770757320642`*^9, 
   3.678777125023246*^9}, {3.6787775361109896`*^9, 3.678777551183764*^9}, {
   3.678777595686551*^9, 3.6787775993642416`*^9}, {3.678777771153384*^9, 
   3.678777781358364*^9}, {3.6787783983338647`*^9, 3.6787784443846297`*^9}, {
   3.678778781621667*^9, 3.6787787873516836`*^9}, {3.6787789014506836`*^9, 
   3.6787789285154085`*^9}, {3.678783540927108*^9, 3.678783569652752*^9}, {
   3.678784571605178*^9, 3.678784575420817*^9}, {3.6787846268015904`*^9, 
   3.6787846292105665`*^9}, {3.678784793020409*^9, 3.6787847933337355`*^9}, {
   3.6787848721709366`*^9, 3.6787848722295623`*^9}, {3.678784917131706*^9, 
   3.6787849172408113`*^9}, {3.6787960086823397`*^9, 3.6787960138730125`*^9}},
 FormatType->"InputForm"],

Cell[BoxData["0.009832352599832731`"], "Output",
 CellChangeTimes->{
  3.6787846317760925`*^9, 3.6787847573406773`*^9, {3.678784790115854*^9, 
   3.678784793895378*^9}, 3.6787848730433135`*^9, 3.67878491872416*^9, 
   3.678785452598486*^9, 3.678796023746252*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pBd", "[", 
   RowBox[{
   "2", ",", "0.5", ",", "0.001", ",", "0.001", ",", "0.4", ",", "5", ",", 
    "10", ",", "0.3", ",", "3"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.6787847032358875`*^9, 3.6787847102677565`*^9}, {
  3.678785459862121*^9, 3.678785488066905*^9}, {3.6787859845846386`*^9, 
  3.678785984699691*^9}, {3.6787960156880608`*^9, 3.6787960163396535`*^9}, {
  3.6787960509076567`*^9, 3.6787960724174595`*^9}}],

Cell[BoxData["0.0023608475454926312`"], "Output",
 CellChangeTimes->{
  3.6787847113666835`*^9, 3.678784757367199*^9, {3.678785452622484*^9, 
   3.6787854885818644`*^9}, 3.6787859862012963`*^9, {3.6787960237787547`*^9, 
   3.6787960740677214`*^9}}]
}, Open  ]],

Cell["", "Input",
 CellChangeTimes->{{3.6787850959765882`*^9, 3.6787851202648277`*^9}, {
  3.6787854434488783`*^9, 3.6787854583025246`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pBnTest", "[", 
   RowBox[{
   "i_", ",", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", "p_", 
    ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}], "]"}],
   " ", ":=", " ", 
  RowBox[{
   RowBox[{"pBnTest", "[", 
    RowBox[{
    "i", ",", " ", "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", 
     "Nt", ",", "L", ",", "d", ",", " ", "Nv"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lambda", " ", "mun", " ", "p", " ", "pimonebd"}], "+", 
         RowBox[{"lambda", " ", "mud", " ", "p", " ", "pimonebn"}]}], ")"}]}],
       ")"}], "]"}], "//.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pnotC", "\[Rule]", " ", 
       RowBox[{"pnot", "[", 
        RowBox[{
        "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", 
         "L", ",", "d", ",", " ", "Nv"}], "]"}]}], ",", " ", 
      RowBox[{"pimonebn", " ", "\[Rule]", " ", 
       RowBox[{"pBnTest", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
         " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
         "Nv"}], "]"}]}], ",", " ", 
      RowBox[{"pimonebd", " ", "\[Rule]", " ", 
       RowBox[{"pBdTest", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", " ", "lambda", ",", " ", "mun", ",", 
         " ", "mud", ",", "p", ",", "Nt", ",", "L", ",", "d", ",", " ", 
         "Nv"}], "]"}]}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.678795406715831*^9, 3.6787954199134216`*^9}, {
   3.6787954832837057`*^9, 3.6787955144526052`*^9}, {3.6787956187473392`*^9, 
   3.678795620920229*^9}, {3.678795687542856*^9, 3.678795690307271*^9}, 
   3.6787959305340633`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pBnTest", "[", 
    RowBox[{
    "0", ",", " ", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", 
     "p_", ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}],
     "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pnot", "[", 
       RowBox[{
       "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", 
        "L", ",", "d", ",", " ", "Nv"}], "]"}], " ", "-", " ", 
      RowBox[{"Nv", "/", "L"}]}], ")"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pBdTest", "[", 
    RowBox[{
    "0", ",", " ", "lambda_", ",", " ", "mun_", ",", " ", "mud_", ",", " ", 
     "p_", ",", " ", "Nt_", ",", " ", "L_", ",", " ", "d_", ",", " ", "Nv_"}],
     "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pnot", "[", 
       RowBox[{
       "lambda", ",", " ", "mun", ",", " ", "mud", ",", "p", ",", "Nt", ",", 
        "L", ",", "d", ",", " ", "Nv"}], "]"}], " ", "-", " ", 
      RowBox[{"Nv", "/", "L"}]}], ")"}], "*", " ", 
    RowBox[{"(", "d", ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6787955187380123`*^9, 3.6787955228432307`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pBnTest", "[", 
   RowBox[{
   "1", ",", "0.5", ",", "0.001", ",", "0.001", ",", "0.4", ",", "5", ",", 
    "10", ",", "0.3", ",", "3"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.6787954462688184`*^9, 3.6787954614283967`*^9}}],

Cell[BoxData[
 RowBox[{"-", "12.230764878969397`"}]], "Output",
 CellChangeTimes->{{3.678795462185561*^9, 3.678795488944587*^9}, 
   3.6787955334068136`*^9, 3.678795946320851*^9, 3.6787960238727922`*^9}]
}, Open  ]]
},
WindowSize->{1904, 958},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 488, 11, 31, "Input"],
Cell[1049, 33, 927, 19, 52, "Input"],
Cell[1979, 54, 76, 1, 31, "Input"],
Cell[2058, 57, 1218, 17, 31, "Input"],
Cell[3279, 76, 4818, 124, 112, "Input"],
Cell[8100, 202, 10123, 232, 369, "Input"],
Cell[CellGroupData[{
Cell[18248, 438, 348, 7, 31, "Input"],
Cell[18599, 447, 613, 8, 31, "Output"]
}, Open  ]],
Cell[19227, 458, 96, 1, 31, "Input"],
Cell[19326, 461, 7661, 182, 226, "Input"],
Cell[26990, 645, 2013, 53, 72, "Input"],
Cell[CellGroupData[{
Cell[29028, 702, 1668, 43, 52, "Input"],
Cell[30699, 747, 2429, 49, 338, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33165, 801, 1008, 22, 31, "Input"],
Cell[34176, 825, 2187, 59, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36400, 889, 454, 8, 31, "Input"],
Cell[36857, 899, 438, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37332, 910, 295, 6, 31, "Input"],
Cell[37630, 918, 384, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38051, 928, 1218, 16, 31, "Input"],
Cell[39272, 946, 262, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39571, 955, 465, 9, 31, "Input"],
Cell[40039, 966, 248, 4, 31, "Output"]
}, Open  ]],
Cell[40302, 973, 140, 2, 31, "Input"],
Cell[40445, 977, 1827, 43, 92, "Input"],
Cell[42275, 1022, 1283, 34, 52, "Input"],
Cell[CellGroupData[{
Cell[43583, 1060, 266, 6, 31, "Input"],
Cell[43852, 1068, 203, 3, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
